plugins:
  #####################################
  # Certificate related plugins
  secret-openssl-ca:
    shortCut: Ctrl-O
    confirm: false
    description: Openssl ca.crt
    scopes:
      - secrets
    command: bash
    background: false
    args:
      - -c
      - kubectl get secret --context $CONTEXT -n $NAMESPACE $NAME -o jsonpath='{.data.ca\.crt}' | base64 -d | openssl storeutl -noout -text -certs /dev/stdin |& less
  secret-openssl-tls:
    shortCut: Shift-O
    confirm: false
    description: Openssl tls.crt
    scopes:
      - secrets
    command: bash
    background: false
    args:
      - -c
      - kubectl get secret --context $CONTEXT -n $NAMESPACE $NAME -o jsonpath='{.data.tls\.crt}' | base64 -d | openssl storeutl -noout -text -certs /dev/stdin |& less

  #####################################
  # View user-supplied values when the helm chart was created
  helm-values:
    shortCut: v
    confirm: false
    description: Values
    scopes:
      - helm
    command: sh
    background: false
    args:
      - -c
      - "helm get values $COL-NAME -n $NAMESPACE --kube-context $CONTEXT | less -K"

  #####################################
  # Cloud Native PostgreSQL
  cnpg-backup:
    shortCut: b
    description: Backup
    scopes:
      - cluster
    command: bash
    confirm: true
    background: false
    args:
      - -c
      - "kubectl cnpg backup $NAME -n $NAMESPACE --context \"$CONTEXT\" |& less -R"
  cnpg-hibernate-status:
    shortCut: h
    description: Hibernate status
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg hibernate status $NAME -n $NAMESPACE --context \"$CONTEXT\" |& less -R"
  cnpg-hibernate:
    shortCut: Shift-H
    description: Hibernate
    confirm: true
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg hibernate on $NAME -n $NAMESPACE --context \"$CONTEXT\" |& less -R"
  cnpg-hibernate-off:
    shortCut: Shift-H
    description: Wake up hibernated cluster in this namespace
    confirm: true
    scopes:
      - namespace
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg hibernate off $NAME -n $NAME --context \"$CONTEXT\" |& less -R"
  cnpg-logs:
    shortCut: l
    description: Logs
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg logs cluster $NAME -f -n $NAMESPACE --context $CONTEXT"
  cnpg-psql:
    shortCut: p
    description: PSQL shell
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg psql $NAME -n $NAMESPACE --context $CONTEXT"
  cnpg-reload:
    shortCut: r
    description: Reload
    confirm: true
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg reload $NAME -n $NAMESPACE --context \"$CONTEXT\" |& less -R"
  cnpg-restart:
    shortCut: Shift-R
    description: Restart
    confirm: true
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg restart $NAME -n $NAMESPACE --context \"$CONTEXT\" |& less -R"
  cnpg-status:
    shortCut: s
    description: Status
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg status $NAME -n $NAMESPACE --context \"$CONTEXT\" |& less -R"
  cnpg-status-verbose:
    shortCut: Shift-S
    description: Status (verbose)
    scopes:
      - cluster
    command: bash
    background: false
    args:
      - -c
      - "kubectl cnpg status $NAME -n $NAMESPACE --context \"$CONTEXT\" --verbose |& less -R"
